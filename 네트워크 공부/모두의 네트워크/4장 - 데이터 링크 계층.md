# 4장 데이터 링크 계층 : 랜에서 데이터 전송하기

## 12 - 데이터 링크 계층의 역할과 이더넷

#### 이더넷이란?

- 랜에서 데이터를 주고 받으려면 **데이터 링크 계층**의 기술이 필요하다.
- 데이터 링크 계층은 **네트워크 장비 간에 신호를 주고받는 규칙**을 정하는 계층이다.
- 가장 일반적으로 많이 사용되는 규칙은 **이더넷**이다.
  - 이더넷은 허브와 같은 장비에 연결된 컴퓨터와 데이터를 주고 받을 때 사용한다.

<br>

- 허브는 들어온 데이터를 그대로 모든 포트에 보내기만 한다.
  - 충돌(collision)이 일어날 수 있다.
- 이더넷은 **여러 컴퓨터가 동시에 데이터를 전송해도 충돌이 일어나지 않는 구조**로 되어있다.
  - 데이터를 보내는 시점을 늦추는 것으로 **CSMA/CD**(반송파 감지 다중 접속 및 충돌 탐지)라고 한다.
    - CS는 데이터를 보내려고 하는 컴퓨터가 케이블에 신호가 흐르고 있는지 확인한다는 규칙이다.
    - MA는 케이블에 데이터가 흐르고 있지 않으면 데이터를 보내도 된다는 규칙앋.
    - CD는 충돌이 발생하고 있는지를 확인한다는 규칙이다.
- 지금은 효율이 좋지 않아서 CSMA/CD를 거의 사용하지 않고 **스위치**(switch)라는 네트워크 장비를 사용해서 충돌을 방지한다.

## 13 - MAC 주소의 구조

#### MAC 주소란?

- 비트열을 전기 신호로 변환하는 랜 카드는 **MAC 주소**(물리 주소)라는 번호가 정해져 있다.
- 제조할 때 새겨지기 때문에 물리 주소라고 불린다.
  - 전 세계에서 유일한 번호로 할당되어 있다.
- 앞 24비트는 랜 카드를 만든 제조사 뒤쪽 24비트는 제조사가 랜 카드에 붙인 일련번호 이다.

<br />

- OSI 모델에서는 **데이터 링크 계층**, TCP/IP 모델에서는 **네트워크 계층**에 해당된다.
- 데이터 링크 계층에서는 **이더넷 헤더**와 **트레일러**를 붙인다.

<br />

- 이더넷 헤더는 목적지의 MAC 주소(6바이트), 출발지 MAC 주소(6바이트), 유형(2바이트) 이렇게 총 14바이트로 구성되어 있다.
  - 이더넷 유형은 전송되는 상위 계층 프로토콜의 종류를 나타내고 프로토콜을 식별하는 16진수 번호가 들어가 있다.
- 트레일러는 FCS(Frame Check Sequence)라고도 하는데, 데이터 전송 도중에 오류가 발생하는지 확인하는 용도이다.

<br />

- 이너넷 헤더와 트레일러가 추가된 데이터를 **프레임**이라고 한다.
  - 네트워크를 통해 프레임이 전송된다.
- 물리 계층에서 이 프레임 비트열을 **전기 신호**로 변환하여 네트워크를 통해 전송한다.
- 한 개의 컴퓨터에서 데이터를 전송하면 포트에서 수신한다. 포트는 연결된 모든 컴퓨터에 데이터를 보내고, 데이터를 수신받을 컴퓨터를 제외한 컴퓨터는 목적지 MAC 주소가 자신의 MAC 주소와 다르기 때문에 파기한다.

## 14 - 스위치 구조

- 스위치는 허브와 달리 데이터 충돌이 발생하지 않는다.

#### MAC 주소 테이블이란?

- 스위치는 **데이터 링크 계층**에서 동작하고 **레이어 2 스위치** 또는 **스위칭 허브**라고 불린다.
- 스위치 내부에서 **MAC 주소 테이블**(MAC address table)이라는 것이 있다.
  - MAC 주소 테이블은 스위치의 **포트 번호**와 해당 포트에 연결 되어 있는 컴퓨터의 **MAC 주소**가 등록되는 데이터베이스이다.
- 컴퓨터에서 목적지 MAC 주소가 추가된 **프레임**이라는 데이터가 전송되면 MAC 주소 테이블을 확인하고 출발지 MAC 주소가 등록되어 있지 않으면 MAC 주소를 포트와 함께 등록한다.
  - 이를 **MAC 주소 학습 기능**이라고 한다.

<br />

- 처음 데이터를 전송할 때 목적이 MAC 주소가 MAC 주소 테이블에 등록되어 있지 않은 상태이다.
- 그래서 송신 포트 이외의 다른 모든 포트에 데이터(프레임)이 전송되는데 이러한 데이터(프레임) 전송을 **플러딩**(flooding)이라고 한다.

<br />

- MAC 주소를 기준으로 목적지를 선택하는 것을 **MAC 주소 필터링**이라고 한다.
