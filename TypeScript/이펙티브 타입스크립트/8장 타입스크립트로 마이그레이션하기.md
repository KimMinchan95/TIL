> <이펙티브 타입스크립트>(댄 밴더캄 지음, 장원호 옮김, 인사이트, 2021)

## 8장 타입스크립트로 마이그레이션하기

- 자바스크립트 프로젝트를 타입스크립트로 마이그레이션 해야하는 이유
  - 2017년 한 조사 에서깃헙에 있는 자바스크립트 프로젝트에서 발견된 버그의 15%는 타입스크립트를 사용했다면 컴파일 시점에서 미리 방지했을 수 있었을 것이다.
  - 에어비앤비에서 진행된 프로젝트 사후 분석 6개월치를 조사해보니, 발견된 버그의 38%가 타입스크립트에서는 방지했을 수 있는 것들이었다.

#### 아이템 58 - 모던 자바스크립트로 작성하기

- 모던 자바스크립트 (ES6) 주요기능을 다루는 챕터

<br />

**프로토타입 대신 클래스 사용하기**

- 프로토타입 대신 `Class` 문법을 사용하면 더 견고하게 코드를 작성할 수 있다.

**`var` 대신 `let`/`const` 사용하기**

- `var`는 함수 스코프 `let`과 `const`는 블록 스코프를 따르기 때문에, 개발자들이 일반적으로 기대하는 방식으로 동작한다.

- `var` 키워드를 `let`가 `const`로 변경하면 타입스크립트에서 일부 코드에 오류를 표시한다.
  - 이 오류는 잠재적으로 스코프 문제가 존재하는 코드이기 때문에 수정해야 한다.
- 함수 선언식 또한 호이스팅으로 실행 순서를 헷깔리게 하므로, 함수 표현식을 사용해서 호이스팅 문제를 피하는 것이 좋다.

**`for(;;)` 대신 `for-of` 또는 배열 메서드 사용하기**

- 배열을 순회할 떄 C스타일의 `for`루프를 사용하는 것 보다 `for-of` 루프 또는 배열 메서드(`forEach` 등)을 사용해서 순환하는 것이 코드도 짧고 인덱스 변수를 사용하지 않기 때문에 실수를 줄일 수 있다.

**함수 표현식보다 화살표 함수 사용하기**

- 화살표 함수를 사용하면 상위 스코프의 `this`를 유지할 수 있다.

```ts
class Foo {
  method() {
    console.log(this);
    [1, 2].forEach((i) => {
      console.log(this);
    });
  }
}
const f = new Foo();
f.method();
// Foo, Foo, Foo
```

- 인라인 or 콜백에서는 일반 함수보다 화살표 함수가 더 직관적이고 코드도 간결해 진다.
- 컴파일러 옵션에 `noImplicitThis` or `strict`를 설정하면 타입스크립트가 `this` 바인딩에 관련된 오류를 표시해 주므로 설정하는 것이 좋다.

**단축 객체 표현과 구조 분해 할당 사용하기**

- 단축 객체

```js
const x = 1,
  y = 2,
  z = 3;
const pt = { x, y, z };
```

- 객체 속성 중 함수 축약

```js
const obj = {
    onClickLong: function(e) {
        // ...
    }.,
    onClickCompact(e) {
        // ...
    }
};
```

- 구조 분해 할당

```js
const {
  props: { a, b },
} = obj;

// 구조 분해 문법 내에서 기본값 지정
const { a = 'default' } = obj.props;
```

**함수 매개변수 기본값 사용하기**

- 기본값 설정으로 선택적 매개변수라는 것을 명확히 나타내는 효과도 줄 수 있다.
- 타입스크립트에서 기본값 기반으로 타입 추론이 가능하기 때문에, 타입스크립트로 마이그레이션할 때 매개변수에 타입 구문을 쓰지 않아도 된다.

<br />

- 매개변수 기본값 예제

```js
function parseNum(str, base = 10) {
  return parseInt(str, base);
}
```

\*\*저수준 프로미스나 콜백 대신 `async`/`await` 사용하기

- `async`/`await`을 사용하면 코드가 간결해져서 버그나 실수를 방지할 수 있다.
- 비동기 코드에 타입 정보가 전달되어 타입 추론을 가능하게 한다.

```js
async function getJson(url: string) {
  const response = await fetch(url);
  return response.json();
}
```

**연관 배열에 객체 대신 Map과 Set 사용하기**

- Object 내에는 'constructor' 같은 생성자 함수가 있다.
  - 의외의 상황에서 버그를 낼 수 있의니 Map을 사용하는 것이 좋다.

**타입스크립트에 use strict 넣지 않기**

- `alwaysStrict` 설정을 추가하는 것이 훨씬 효과적이다.
- 타입스크립트에서 수행되는 안전성 검사(sanity check)가 엄격 모드보다 더 엄격하게 체크하기 때문에, 타입스크립트 코드에서 'use strict'는 무의미하다.
  - 타입스크립트 컴파일러가 생성하는 자바스크립트 코드에는 자동으로 'use strict'가 추가된다.
