# Process vs Thread

[[10분 테코톡] 🌷 코다의 Process vs Thread](https://www.youtube.com/watch?v=1grtWKqTn50&list=PLkfxusmKmLsNDGmER2tmrslpPOTfKhE7j&index=100)

> 주의사항: 용어의 늪에 빠지지 말고 단어들을 혼동해서 사용하지 않기
> 

### 키워드

1. **실행 단위** - cpu core에서 실행하는 하나의 단위로 프로세스와 스레드를 포괄하는 개념
2. **(부연 설명이 없는) 프로세스** - 하나의 스레드만 가지고 있는 단일 스레드 프로세스
3. **동시성** - 한 순간에 여러가지 일이 아니라, 짧은 전환으로 여러가지 일을 동시에 처리하는 것처럼 보이는 것

---

## 프로그램과 프로세스

### 프로그램

> 실행파일
> 
- 파일 시스템에 존재하는 실행파일

### 프로세스

> 프로그램을 실행하게 되면 CPU를 차지하면서 수행하는 수행 주체가 프로세스
> 
- 프로그램을 실행 시키는 실행 주체, 인스턴스라고도 표현
- 프로그램의 하나의 인스턴스가 프로세스

### 프로그램이 프로세스가 되면서 2가지 일이 일어난다.

1. 프로세스가 필요로 하는 Data들이 메모리에 올라간다.
    1. 메모리의 4가지
        1. Code : 실행 명령을 포함하는 코드들
        2. Data : Static 변수 혹은 Global 변수
        3. Heap : 동적 메모리 영억
        4. Stack : 지역변수, 매개변수, 반환 값 등등 일시적인 데이터
2. 해당 프로세스에 대한 정보를 담고 있는 PCB (Process Control Block)가 프로세스 생성시 함께 만들어 진다.
    1. 주요한 정보
        1. Pointer : 프로세스상태 중에 준비상태나 대기상태의 큐를 구현하기 위해 필요
        2. Process State : 현재 프로세스 상태를 담는다.
        3. PID (Process ID) : 고유번호를 담는다.
        4. Program Counter : 다음 명령어를 가르킨다.

## Process & Thread

- 컨테스트 스위칭
    - 우리가 컴퓨터를 사용한다고 할때 여러개의 프로그램을 실행시킨다.
    - 원래 한 프로세스가 실행되기 위해서 CPU를 점유하고 있으면 다른 프로세스는 실행상태에 있을 수 없다.
    - 하나의 작업을 하다가 다른 작업을 수행하면 전의 작업은 꺼지게 되는 것이다.
    - 그래서 다수의 프로세스를 동시에 실행하기 위해 여러 개의 프로세스를 시분할로, 짧은 텀을 반복하면서 전환하며 실행한다.
    
- 쓰레드의 등장 (경량화된 프로세스)
    - 경랑화된 프로세스라고 하는 이유는 하나의 프로세스 안에 다수의 쓰레드가 있을때 공유되는 자원이 있기 떄문이다.
    - 쓰레드는 프로세스의 4개의 메모리중 3가지 Code, Data, Heap 영역을 공통된 자원으로 사용한다.
    - 각 쓰레드는 Stack 부분만을 따로 가지고 있는 것이다.
    - 공유되는 자원이 있기 때문에 컨텍스트 스위칭이 일어날때 캐싱 적중률이 올라간다.
        - 컨텍스트 스위칭 처럼 자원을 전부 빼고 다시 넣을 필요가 없다는 뜻이다.
        

## Multi-process & Multi-thread

### 한 어플리케이션이 여러가지 일을 처리할 경우

- 프로세스
    - 한 프로세스는 하나의 일만 처리할 수 있기 때문에 동시에 처리할 수 없다.
    - 부모 프로세스가 `fork()`해서 자식프로세스를 여러 개 만들어서 일을 처리한다.
    - 이때 자식 프로세스는 부모와 별개의 메모리 영역을 확보한다.
- 쓰레드
    - 쓰레드가 하나 일때 (단일 쓰레드일 때)
        - 해당 프로세스의 하나밖에 없는 쓰레드가 실행단위가 된다.
    - 멀티 쓰레드일때
        - 하나의 어플리케이션에서 여러 일을 동작시킬때 각각의 쓰레드가 해당일을 실행한다.

### 비교

| Multi-process | Multi-thread |
| --- | --- |
| 각 프로세스는 독립적 | Thread끼리 긴밀하게 연결되어 있음 |
| IPC를 사용한 통신 | 공유된 자원으로 통신 비용 절감 |
| 자원 소모적, 개별 메모리 차지 | 공유된 자원으로 메모리가 효율적임 |
| Context Switching 비용이 큼 | Context Switching 비용이 적음 |
| 동기화 작업이 필요하지 않음 | 공유 자원 관리를 해야함 |
- IPC통신 : 프로세스 간 통신(Inter-Process Communication)이란 프로세스들 사이에 서로 데이터를 주고받는 행위 또는 그에 대한 방법이나 경로를 뜻한다.

### 멀티 프로세스를 사용하는 이유

**멀티 쓰레드가 압도적으로 좋아보이는데 멀티 프로세스를 사용하는 이유**

- 멀티 쓰레드는 긴밀하게 연결되어 있기 때문에 한 쓰레드에 문제가 생기면 전체 프로세스의 영향이 간다.
- 크롬은 멀티 프로세스를 사용해서 멀티탭 간의 영향을 덜 받는다.

## Multi-Core

- Multi-process와 Multi-thread는 ‘처리방식’의 일종이기 때문에 소프트웨어 분야에 가깝다.
- Multi-core는 하드웨어 측면에 가깝다.

- 싱글 코어를 가진 CPU는 실행 단위를 처리할 때는 동시에 여러 가지가 진행되기 위해서 빠른 텀으로 전환이 되면서 실행된다. (동시성)
- 멀티 코어는 물리적으로 여러 개의 코어를 사용해서 다수의 실행단위를 한순간에 처리할 수 있다.

### 비교

| Single-Core | Multi-Core |
| --- | --- |
| Concurrency (동시성) | Parallelism (병렬처리) |
| 하나의 코어에서 하나 이상의 프로세스(혹은 쓰레드)가 번걸아가면서 진행되지만 동시에 진행되는 것처럼 보이는 것 | 둘 이상의 코어에서 동시에 하나 이상의 프로세스(혹은 쓰레드)가 한꺼번에 진행되는 것 |

## 요약

1. 프로세스는 프로그램이 실행된 것이다.
2. 쓰레드는 한 프로세스 내에서 나뉘어진 하나 이상의 실행 단위이다.
3. 한 어플리케이션에 대한 작업을 동시에 하는 2가지 처리 방식(멀티 프로세스, 멀티 쓰레드)이 있다.
4. 동시에 실행이 되는 것처럼 보이기 위해서 실행단위는 시분할로 CPU를 점유하며 Context Switching을 한다.
5. 멀티 프로세스는 독립적인 메모리를 가지고 있지만 멀티 쓰레드는 자원을 공유한다.
6. 멀티 코어는 하드웨어 측면에서 실행 단위를 병렬적으로 처리할 수 있도록 여러 프로세서가 있는 것이다.

---

### 참고자료

[프로세스와 프로그램 차이는? - 양햄찌](https://jhnyang.tistory.com/6)

[프로세스 간 통신 - 위키백과, 우리 모두의 백과사전](https://ko.wikipedia.org/wiki/%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4_%EA%B0%84_%ED%86%B5%EC%8B%A0)