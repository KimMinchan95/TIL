# HTTPS

[[10분 테코톡] 🍭 다니의 HTTPS](https://www.youtube.com/watch?v=wPdH7lJ8jf0&t=1s)
[[10분 테코톡] 라쿤의 HTTPS](https://www.youtube.com/watch?v=Il3xLZ4b7NM&list=PLkfxusmKmLsNDGmER2tmrslpPOTfKhE7j&index=109)

## HTTP vs HTTPS

- **HTTP(HyperText Transfer Protocal)** : 서로 다른 시스템들 사이에 통신을 주고받게 하는 가장 기본적인 프로토콜
    - 서버에서 브라우저로 데이터를 전송하는 용도로 가장 많이 사용함
    - 서버에서 브라우저로 전송되는 정보가 암호화되지 않는다.

- HTTPS(HyperText Transfer Protocol Secure) : HTTP에 SSL/TLS을 사용한 프로토콜
    - SSL(보안 소켓 계층) 사용
        - SSL은 서버와 브라우저 사이에서 안전하게 암호화된 연결을 만들 수 있게 도와주고 서버와 브라우저가 민감한 정보를 주고받을 때 해당 정보가 도난당하는 것을 막아준다.
    - HTTPS가 HTTP 자체를 암호화 하는 것은 아니다.
        - HTTP Message **Body**를 암호화 한다.
        - HTTP **Header**는 암호화되지 않는다.
    - 암호화 과정
        - 클라이언트가 SSL 계층으로 평문 데이터를 전송
        - SSL 계층을 거치면서 암호화된 http 메시지로 변경
        - 서버측 SSL 계층에 도착하면 이 암호화된 http 메시지가 복호화된다.클라이언

### HTTPS를 사용해야하는 이유

1. 보안성
    - HTTP로 서버에 데이터를 전송하면 원본 그 자체이다.
        - 해커가 데이터를 탈취하면 바로 내용을 알 수 있다.
    - HTTPS로 서버에 데이터를 전송하면 암호화되어 전송된다.
        - 해커가 데이터를 탈취해도 어떤 내용을 전송했는지 알 수없다.
2. SEO
    - HTTPS 웹 사이트에 가산점을 준다.
    - 검색엔진에 더 빈번하게 노출되고 싶다면, HTTPS를 필수적으로 사용해야 한다.
    - AMP(가속화된 모바일 페이지)를 만들려면 HTTPS를 사용해야만한다.

## SSL/TLS

- SSL(Secure Sockets Layer) : Netscape Communications Corporation에서 웹 서버와 웹 브라우저간의 보안을 위해 만든 프로토콜
    - 공개키/개인키 대칭키 혼용해서 사용한다.
    - SSL의 업그레이드 버전이 TLS이다.
    - 보통 SSL과 TLS 용어를 혼용해서 사용한다.

### 대칭키, 공개키

- 대칭키
    - 암호화와 복호화를 같은 키를 사용해서 키를 가지고 있으면 쉽게 데이터의 내용을 알 수있다.
    - 암호화 연산시간이 짧다.
- 공개키
    - 서로 다른 키로 암호화와 복호화를 한다.
    - 데이터 암호화 시에는 공개키를 사용 - 공개키를 해킹 당해도 데이터를 알 수 없다.
    - 데이터 복호화 시에는 개인키를 사용
    - 암호화 연산시간이 길다.

**위와 같이 대칭키와 공개키가 장, 단점이 분명해서 SSL은 혼용해서 사용한다.**

- SSL은 공개키 방식으로 대칭키를 전송한다.

### SSL 사용 이유

- 브라우저와 서버간 전송되는 데이터를 보호하기 위해 사용된다.

### HTTPS 적용 사전에 서버가 해야하는 행동

인증서 발급

- 서버는 인증 기관(CA)에게 인증서 발급요청과 서버의 정보를 전송한다.
- 인증 기관은 인증기관이 가지고 있는 비밀키를 사용해서 정보에 대한 인증서를 발급해 준다.
    - 인증서에는 “서버 도메인, 서버측 공개키, 인증 기관 정보 등”이 들어간다.

## SSL 통신 과정

- 브라우저에서 서버로 접속 요청을 한다고 가정했을때
    1. 클라이언트가 서버에게 요청을 한다.
    2. 서버는 클라이언트에게 인증서를 발급한다. - 서버의 공개키가 클라이언트에게 전송된다.
    3. 인증서를 복호화할때는 웹 브라우저에 저장되어 있는 인증기관의 공개키를 사용한다.
    4. 클라이언트는 대칭키를 만든다. (공개키 암호화 방식에 비해 빠르기 때문에)
    5. 대칭키를 공개키 암호해서 서버로 전달한다.
    6. 서버는 서버의 비밀키를 사용해서 대칭키를 얻는다.
    7. 이제 클라이언트와 서버 모두 대칭키를 가지고 있다.
    8. 이후에는 클라이언트와 서버 모두 대칭키로 암호화해서 요청과 응답을 전송한다