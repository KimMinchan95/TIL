# Render and Commit

- React가 UI를 요청하고 제공하는 과정은 3 단계이다.

1. 렌더링 **트리거**
2. 컴포넌트 **렌더링**
3. DOM에 **커밋**

## 1단계: 렌더링 트리거

- 컴포넌트 렌더링이 일어나는 데에는 두 가지 이유가 있다.

1. 컴포넌트의 **초기 렌더링인 경우**
2. 컴포넌트의 **state가 업데이트된 경우**

**초기 렌더링**

- 앱을 시작할때 초기 렌더링를 실행해야한다.
- `createRoot`를 타겟 DOM 노드와 함께 호출한 다음 `render` 메서드를 호출하면 된다.

```jsx
import Index from './index.js';
import { createRoot } from 'react-dom/client';

const root = createRoot(document.getElementById('root'));
root.render(<Index />);
```

#### State 업데이트 시 리렌더링

- 컴포넌트가 초기 렌더링된 후에는 상태의 `set` 함수를 사용해서 추가적인 렌더링을 실행할 수 있다.
- 컴포넌트가 상태를 업데이트하면 렌더링이 자동으로 queue에 들어간다.

## 2단계: React 컴포넌트 렌더링

- 렌더링을 트리거한 후 React는 컴포넌트를 호출해서 화면에 표시할 내용을 파악한다.
  - "렌더링"은 React에서 컴포넌트를 호출하는 것이다.

<br />

- **초기 렌더링에서** React는 루트 컴포넌트를 호출한다.
- **이후 렌더링에서** React는 상태(state) 업데이트가 일어나 렌더링을 트리거한 컴포넌트를 호출한다.

<br />

- 재귀적 단계: 업데이트된 컴포넌트가 다른 컴포넌트를 반환하면 React 다음으로 해당 컴포넌트를 렌더링하고, 해당 컴포넌트도 컴포넌트를 반환하면 반환된 컴포넌트를 다음에 렌더링하는 방식이다. 중첩된 컴포넌트가 더 이상 없고 React가 화면에 표시되어야 하는 내용을 정확히 알 때까지 과정을 반복한다.

**주의**

- 렌더링은 항상 순수한 계산

  - **동일한 입력에는 동일한 출력을 해야한다.**
  - **이전의 state를 변경해서는 안된다.**

- "Strict Mode"에서 개발할 때 React는 각 컴포넌트의 함수를 두 번 호출하여 순수하지 않는 함수로 인한 실수를 표면화하는데 도움을 준다.

## 3단계: React가 DOM에 변경사항을 커밋

- **초기 렌더링의 경우** React는 `appendChild()` DOM API를 사용하여 생성한 모든 DOM 노드를 화면에 표시한다.
- **리렌더링의 경우** React는 필요한 최소한의 작업(렌더링하는 동안 계산된 것!)을 적용하여 DOM이 최신 렌더링 출력과 일치하도록 한다.

<br />

- React는 렌더링 간에 차이가 있는 경우에만 DOM 노드를 변경한다.
