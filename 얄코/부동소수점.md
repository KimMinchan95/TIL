# 부동소수점

[부동소수점 (+ 실수계산 오차가 생기는 이유)](https://www.youtube.com/watch?v=ZQDsWySjY6g&list=PLkfxusmKmLsNDGmER2tmrslpPOTfKhE7j&index=107&t=3s)

프로그래밍을 할때 오차가 생기는 경우가 있다.

예를 들어서 0.1 + 0.2는 0.3이 나올 것이라고 예상하지만 아래와 같은 결과 값이 나온다.

```jsx
console.log(0.1 + 0.2)
// 0.30000000000000004
```

### 이유

- 이는 0.1과 0.2가 사실 0.1과 0.2가 아니기 때문이다.
- 컴퓨터는 2진법으로 모든 데이터를 표현하고 처리한다.
    - 하지만 이 방법은 모든 숫자를 정확하게 표현하지 못한다.

### 10진수에서도 나오는 오차

- 1/3이라는 값을 10진법으로 나타내면 0.33333… 이라는 값으로 표현할 수 있다.
    - 10이나 1/10의 정수 제곱들을 아무리 더해나가도 1/3에는 맞아 떨어지지 않기 때문이다.
    - 계속 무한하게 적을 수는 없기때문에 0.33333 이라는 식으로 표현하면 그 뒤에 있는 숫자는 모두 오차가 된다.
    - 이런 현상으로 컴퓨터가 사용하는 2진법에서도 오차가 발생하는 수들이 생기는 것이다.

### 0.1을 2진수로

- 0.1이라는 숫자를 2진법으로 나타내면 0.0001100110011…이라고 0.1에 가까워 질뿐 정확하게 0.1로 맞아 떨어지게 할 수 없다. 이렇게 무한소수가 된다.

### int(integer)

- JavaScript에서는 없지만 Python과 JAVA에는 존재하는 int라는 자료형이 있다.
- int는 32bits(4bytes)를 사용한다.
    - 0또는 1이 들어가는 32개의 자리를 쓰는 것ㅇ디ㅏ.
- 첫 번째는 `+`or `-` 를 표현한다.
    - 0이면 양수 1이면 음수 이다.
- 나머지 31개로 절대값을 표현한다. 표현범위는 다음과 같다.
    - 음수는 -2의 31 제곱 부터 -1
    - 양수는 0 부터 0의 31 제곱
- 하지만 int는 정수가 아닌 소수점 뒤로 숫자가 있으면 표현하지 못한다.

### 고정소수점

- 32bits의 자료형에서 고정소수점 자리를 사용하면 다음과 같이 동작한다.
- 첫 번째 bit에는 `+`나 `-`를 표현한다.
- 나머지 bits들은 임의의 bits수로 쪼개서 정수부분과 소수를 표현한다. (여기서는 반으로 쪼개는 예시)
    - 앞의 15bits에는 정수를 표현
    - 뒤의 16bits에는 소수를 표현
- 소수점이 고정되어 있으면 다음과 같은 단점이 생긴다.
    - 정수는 큰 숫자를 표현 하지 못한다.
    - 소수는 정밀한 값을 표현할 수 없다.
- 정수 부분이나 소수부분을 쪼개는 숫자를 조정하면 늘린 부분과 반대되는 부분의 표현 가능한 숫자가 줄어든다.
- 이렇게 고정되어 있으면 비트들이 효율적으로 사용되지 못한다.

### float, number (부동소수점, Floating point)

> JAVA와 Python에서 float, JavaScript에서는 number이다.
> 
- 여기서 부동은 떠서 움직인다는 뜻이다.
- 부동소수점은 모든 숫자를 1.xxxxxx 형식으로 표현한다.
    - 예를 들어 1001.101은 부동소수점으로 1.001101로 표현된다.
- 첫 번째 bit는 `+`or `-`를 표현한다.
- 다음 8bit로 소수점이 몇 칸을 움직여야하는지 표현한다.
- 나머지 23자리에 소수점 뒤로 오는 부분을 채워 넣는다.
- 32비트 중 1bit(부호), 8bits(지수), 23bits(가수)를 할당하는 방식이 컴퓨터에서 널리 사용되는 IEEE 754 표준 방식이다.

**정확한 숫자를 계산하고 싶으면 big.js 같은 라이브러리를 사용하면 된다.**